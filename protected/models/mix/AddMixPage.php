<?php/** * Created by PhpStorm. * User: rik * Date: 14-11-28 * Time: 下午2:04 */class AddMixPage extends CBaseFormModel {    public $cloth_ids;//    public $top;//    public $bottom;//    public $shoe;//    public $bag;//    public $ornament;    public $understanding;    public $occasion;    public $style;    public $feeling;    public $for_date;    public $info;    public $get_array = array(        "cloth_ids",//        "top", "bottom",//        "shoe", "bag",        "info",//        "ornament",        "understanding",        "occasion", "style",        "feeling", "for_date"    );    public function rules() {        return array(//            array("username, password", "required")        );    }    public function _execute() {        $mix = new Mix();        $mix->user_id = LoginPage::$user->id;        $mix->time = time();        if($this->cloth_ids) {            $mix->cloth_ids = $this->cloth_ids;        }        if($this->understanding)            $mix->understanding = $this->understanding;        if($this->info)            $mix->info = $this->info;        if($this->occasion)            $mix->occasion = $this->occasion;        if($this->style)            $mix->style = $this->style;        if($this->feeling)            $mix->feeling = $this->feeling;        if($this->for_date)            $mix->for_date = $this->for_date;        $mix->save();        $cloth_ids = explode(';', $this->cloth_ids);        if(sizeof($cloth_ids) > 0) {            foreach($cloth_ids as $cloth_id) {                $clothExt = ClothExt::model()->find('id=:id', array('id' => $cloth_id));                $clothExt->use_count = $clothExt->use_count + 1;                $clothExt->save();            }        }        return 'success';    }}